


# compilation of libUSB
if(APPLE)
  find_library(quicktimeFramework QuickTime)
  find_library(iokitFramework     IOKit)
  find_library(carbonFramework    Carbon)
  find_library(cocoaFramework     Cocoa)
  find_library(systemFramework    System)
  find_library(webkitFramework    Webkit)
  find_library(audioToolboxFramework AudioToolbox)
  find_library(openGLFramework    OpenGL)

  set(PHD_LINK_EXTERNAL ${QuickTime} ${IOKit} ${Carbon} ${Cocoa} ${System} ${Webkit} ${AudioToolbox} ${OpenGL})

  find_program(wxWidgets_CONFIG_EXECUTABLE NAMES "wx-config" PATHS /Users/raffi/Code/EI/usr/local/bin NO_DEFAULT_PATH)
  if(NOT wxWidgets_CONFIG_EXECUTABLE)
    message(FATAL_ERROR "Cannot find wxWidgets_CONFIG_EXECUTABLE: ${wxWidgets_CONFIG_EXECUTABLE}")
  endif()
  
  find_path(CARBON_INCLUDE_DIR Carbon.h)
  message(STATUS "Carbon header found at ${CARBON_INCLUDE_DIR}")
  
  #set(wxWidgets_CONFIG_OPTIONS --prefix=/Users/raffi/Code/EI/usr/local)
  
  find_package(wxWidgets)
  if(NOT wxWidgets_FOUND)
    message(FATAL_ERROR "WxWidget cannot be found. Please use wx-config prefix")
  endif()
  set(PHD_LINK_EXTERNAL ${PHD_LINK_EXTERNAL} ${wxWidgets_LIBRARIES})
  
  # cfitsio
  if(NOT EXISTS ${CMAKE_SOURCE_DIR}/thirdparties/cfitsio)
    # untar the dependency
    execute_process(${CMAKE_COMMAND} -E tar xzf ${CMAKE_SOURCE_DIR}/thirdparties/cfitsio3370.tar)
  endif()
  
  set(BUILD_SHARED_LIBS OFF)
  set(USE_PTHREADS OFF)
  add_subdirectory(${CMAKE_SOURCE_DIR}/thirdparties/cfitsio)
  
  if(WIN32)
    set(cfitsio_LIB_NAME cfitsio)
  else()
    set(cfitsio_LIB_NAME libcfitsio)
  endif()
  
  include_directories(${CMAKE_SOURCE_DIR}/thirdparties/cfitsio)
  set(PHD_LINK_EXTERNAL ${PHD_LINK_EXTERNAL} ${cfitsio_LIB_NAME})
  
  

endif()


